"use strict";function createCategory(t){function n(t){g.each(e(.9*t.alpha)).each(r(.5)).attr("cx",function(t){return t.x-20}).attr("cy",function(t){return t.y}),h.attr("x",function(t){return-1===media.indexOf(t.name)?t.x:t.x-40}).attr("y",function(t){return t.y}),O.attr("x",function(t){return-1===media.indexOf(t.name)?t.x:t.x-40}).attr("y",function(t){return t.y+20})}function e(t){return function(n){n.y+=(n.cy-n.y)*t,n.x+=(n.cx-n.x)*t}}function r(t){var n=d3.geom.quadtree(f);return function(e){var r=e.radius+c+a,o=e.x-r,i=e.x+r,u=e.y-r,f=e.y+r;n.visit(function(n,r,c,d,x){if(n.point&&n.point!==e){var y=e.x-n.point.x,s=e.y-n.point.y,l=Math.sqrt(y*y+s*s),m=e.radius+n.point.radius+(e.color!==n.point.color)*a;l<m&&(l=(l-m)/l*t,e.x-=y*=l,e.y-=s*=l,n.point.x+=y,n.point.y+=s)}return r>i||d<o||c>f||x<u})}}var i,a=6,c=12,u=function(t){return mediaColor[t]},f=[],d=(Object.keys(t).map(function(n){return Object.keys(t[n].category).length}),0);for(var x in t){var y=[],s=d3.scale.ordinal().domain(d3.range(14)).rangePoints([40,1e3],1);i=0,f.push({radius:Math.sqrt(t[x].news_count)*c/20,color:u(x),cx:180*d+90,x:180*d+90,cy:s(i),y:s(i),name:x,count:t[x].news_count}),i+=2;for(o in t[x].category){if(i>12)break;y.push({radius:Math.sqrt(t[x].category[o])*c/20,color:u(x),cx:180*d+90,x:180*d+90,name:o,count:t[x].category[o]}),i++}y.sort(function(t,n){return d3.descending(t.count,n.count)}),y.forEach(function(t,n){t.cy=s(n+2),t.y=s(n+2),t.order=n}),f=f.concat(y),d++}var l=d3.layout.force().nodes(f).size([880,1e3]).on("tick",n).start(),m=d3.select("#category").append("svg").attr("width",880).attr("height",1e3),p=m.selectAll("circle").data(f).enter(),g=p.append("circle").attr("r",function(t){return t.radius}).style("fill",function(t){return-1===media.indexOf(t.name)?"none":t.color}).style("stroke",function(t){return-1===media.indexOf(t.name)?t.color:"#D3D3D3"}).style("stroke-width",function(t){return media.indexOf(t.name),2}).call(l.drag);m.selectAll("circle").style("opacity",function(t){return.08*(9-(t.order?t.order:0))});var h=p.append("text").text(function(t){return t.name}).attr("x",function(t){return-1===media.indexOf(t.name)?t.x+5:t.x-40}).attr("y",function(t){return t.y}).style("font-weight",function(t){return-1===media.indexOf(t.name)?"":"600"}).style("font-size",function(t){return-1===media.indexOf(t.name)?"":"20px"}).style("fill","rgba(0,0,0,0.75)"),O=p.append("text").text(function(t){return t.count+"å‰‡"}).attr("x",function(t){return-1===media.indexOf(t.name)?t.x+5:t.x-40}).attr("y",function(t){return t.y+20}).style("fill","rgba(0,0,0,0.75)")}